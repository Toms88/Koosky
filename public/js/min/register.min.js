function test(e){var r=new RegExp("^[a-z0-9]+([_|.|-]{1}[a-z0-9]+)*@[a-z0-9]+([_|.|-]{1}[a-z0-9]+)*[.]{1}[a-z]{2,6}$","i");return r.test(e)?!0:!1}var $send=$("#send"),$email=$("#email"),$register=$("#regform"),$mess=$("#message"),$user=$("#user"),$first=$("#first"),$last=$("#last"),$tel=$("#tel"),$address=$("#address"),$postal=$("#postal"),$city=$("#city"),$ulen=$("#ulen"),$flen=$("#flen"),$llen=$("#llen"),$tlen=$("#tlen"),$vlen=$("#vlen"),$adlen=$("#adlen"),$polen=$("#polen"),$pwlen=$("#pwlen"),$pwverif=$("#pwverif"),$everif=$("#everif"),$averif=$("#averif"),$cityverif=$("#cityverif"),$veruser=$("#veruser"),$veremail=$("#veremail"),username,fname,lname,tel,address,postal,email,type;$ulen.hide(),$flen.hide(),$llen.hide(),$tlen.hide(),$vlen.hide(),$adlen.hide(),$polen.hide(),$pwlen.hide(),$pwverif.hide(),$everif.hide(),$averif.hide(),$cityverif.hide(),$veruser.hide(),$veremail.hide(),$(document).ready(function(){var e;$city.autocomplete({source:function(e,r){$.ajax({url:"/comp",dataType:"json",data:{Name:$city.val(),maxRows:5}}).done(function(e){r($.map(e,function(e){return e.Name}))}).fail(function(){console.log("fail !")}).always(function(){console.log("we did it !")})},minLength:3}),$send.click(function(){return username=$user.val(),username.length<4||null==username||void 0==typeof username?($register.addClass("has_error"),$ulen.show(400).delay(2e3).hide(400),$register.removeClass("has_error"),!1):void socket.emit("veruser",username)}),socket.on("userdb",function(e){if(0==e)return $register.addClass("has_error"),$veruser.show(400).delay(2e3).hide(400),$register.removeClass("has_error"),!1;if(fname=$first.val(),fname.length<2||null==fname||void 0==typeof fname)return $register.addClass("has_error"),$flen.show(400).delay(2e3).hide(400),$register.removeClass("has_error"),!1;if(lname=$last.val(),lname.length<2||null==lname||void 0==typeof lname)return $register.addClass("has_error"),$llen.show(400).delay(2e3).hide(400),$register.removeClass("has_error"),!1;if(tel=$tel.val(),10!=tel.length||null==tel||void 0==typeof tel)return $register.addClass("has_error"),$tlen.show(400).delay(2e3).hide(400),$register.removeClass("has_error"),!1;if("0"!=tel[0])return $register.addClass("has_error"),$vlen.show(400).delay(2e3).hide(400),$register.removeClass("has_error"),!1;if(address=$address.val(),socket.emit("address",address),address.charCodeAt(0)<48||address.charCodeAt(0)>57||"undefined"==typeof address||null==address)return $register.addClass("has_error"),$adlen.show(400).delay(2e3).hide(400),$register.removeClass("has_error"),!1;var r=$city.val();return"undefined"==typeof r?($register.addClass("has_error"),$cityverif.show(400).delay(2e3).hide(400),$register.removeClass("has_error"),!1):void socket.emit("vercity",r)}),socket.on("citydb",function(e){return 0==e?($register.addClass("has_error"),$cityverif.show(400).delay(2e3).hide(400),$register.removeClass("has_error"),!1):(postal=$postal.val(),5!=postal.length||null==postal||void 0==typeof postal?($register.addClass("has_error"),$polen.show(400).delay(2e3).hide(400),$register.removeClass("has_error"),!1):(email=$email.val(),0==test(email)?($register.addClass("has_error"),$everif.show(400).delay(2e3).hide(400),$register.removeClass("has_error"),!1):void socket.emit("veremail",email)))}),socket.on("emaildb",function(r){if(0==r)return $register.addClass("has_error"),$veremail.show(400).delay(2e3).hide(400),$register.removeClass("has_error"),!1;if(console.log("valid"),type=document.getElementById("type").value,console.log("acctype "+type),"visiteur"!=type&&"Ã©tudiant"!=type)return $register.addClass("has_error"),$averif.show(400).delay(2e3).hide(400),$register.removeClass("has_error"),!1;console.log("cool ! c'est valide"),$register.css("display",("none"===$register.css("display"),"none")),$mess.empty().html("<p>Please wait a few time... </p>"),e=$email.val();$.get("/send",{to:e}).done(function(){$register.submit(),$mess.empty().html('<p>email was sent ! </p><br /><p>if you click <a href="/">here</a> you will go to Homepage ! </p>')}).fail(function(){$mess.empty().html("<p>an error occured ! </p>")})})});